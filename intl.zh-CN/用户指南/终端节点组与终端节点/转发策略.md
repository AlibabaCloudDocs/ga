---
keyword: [转发策略, 路径, 域名, 虚拟终端节点组]
---

# 转发策略

HTTP或HTTPS协议的监听支持配置基于域名或基于路径的转发策略。HTTPS或HTTP协议的监听接受到访问请求后会根据转发策略将不同域名或不同路径的访问请求转发至后端对应的终端节点组中。

-   目前仅HTTP或HTTPS协议的监听支持配置转发策略，请确保您已经添加了HTTP或HTTPS协议的监听。具体操作，请参见[添加监听](/intl.zh-CN/用户指南/监听/添加监听.md)。
-   您已经添加了虚拟终端节点组。具体操作，请参见[添加虚拟终端节点组](/intl.zh-CN/用户指南/终端节点组与终端节点/设置终端节点组.md)。

转发策略分为默认转发策略和自定义转发策略：

-   默认转发策略：在您创建HTTP或HTTPS监听后，系统自动创建一条默认转发策略关联到默认终端节点组。一个监听实例中只有一条默认转发策略且不支持更改和删除。
-   自定义转发策略：在您创建HTTP或HTTPS监听后，您可以根据实际需求手动创建自定义转发策略。一个监听实例中可以创建多个自定义转发策略。

每个转发策略均包含以下两个部分：

-   转发条件：访问请求只有匹配转发条件后，才会被转发至对应的终端节点组。您可以有以下三种方式配置您的转发条件：
    -   只配置域名。一个转发策略只支持配置一个域名作为转发条件，访问请求匹配到域名后才可被转发至对应的终端节点组。
    -   只配置路径。一个转发策略可以配置多个路径作为转发条件，访问请求只要匹配到其中一个路径即可被转发至对应的终端节点组。
    -   同时配置域名和路径。访问请求只要匹配到域名和其中的一个路径即可被转发至对应的终端节点组。
-   转发动作：转发动作指向终端节点组。一个转发策略只允许指向一个终端节点组。

一个监听实例中可以包含一个默认转发策略和多个自定义转发策略，系统通过以下两种方式匹配您的访问请求：

-   方式一：访问请求中存在域名，则根据域名匹配转发策略。
    -   存在匹配该域名的转发策略，则继续匹配路径部分。

        若路径部分也能匹配，则将访问请求转发到对应的终端节点组；若路径部分未能命中该域名下的任何路径转发条件，则将访问请求转发给该域名的根路径转发策略（即只配置了该域名作为转发条件，没有配置路径的转发策略）。

        若当前监听实例没有配置该域名的根路径转发策略时，则向客户端返回404错误。

    -   不存在匹配该域名的转发策略，则按照方式二匹配转发策略。
-   方式二：访问请求中不存在域名或者监听实例中不存在匹配该域名的转发策略，则直接匹配无域名转发策略（即只配置了路径作为转发条件，没有配置域名的转发策略）。

通过以上两种方式成功匹配到转发策略的，访问请求将被转发到对应的终端节点组；未能匹配到转发策略的，访问请求将直接通过默认转发策略被转发到默认终端节点组。

![域名和路径匹配流程](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/8034281161/p235742.png)

## 添加转发策略

在您创建HTTP或HTTPS监听后，系统自动创建一条默认转发策略关联到默认终端节点组。默认转发策略不支持修改和删除。您可以通过以下步骤添加、修改和删除自定义转发策略。

1.  登录[全球加速管理控制台](https://ga.console.aliyun.com/list)。

2.  在**实例列表**页面，找到目标全球加速实例，单击**操作**列下的**配置监听**。

3.  在**监听**页签下，找到目标监听，然后单击监听实例ID。

4.  在监听实例详情页面下，单击**转发策略**页签。

5.  在**转发策略**页签下，单击**插入新策略**，然后根据以下信息进行配置。

    |参数|说明|
    |--|--|
    |**如果（条件全部匹配）**|配置转发条件。    -   **域名**

域名长度为3~128个字符，允许包含字母、数字、短划线（-）和半角句号（.），支持使用星号（\*）和半角问号（?）作为通配符。

    -   **路径**

路径长度为1~128个字符，必须以正斜线（/）开头，只允许包含字母、数字、美元符号（$）、短划线（-）、下划线（\_）、半角句号（.）、加号（+）、正斜线（/）、and（&）、波浪线（~）、at（@）、半角冒号（:）、撇号（'），支持使用星号（\*）和半角问号（?）作为通配符。 |
    |**那么转发至虚拟终端节点组**|选择目标虚拟终端节点组。|

6.  单击**确定**。


## 编辑转发策略

1.  登录[全球加速管理控制台](https://ga.console.aliyun.com/list)。

2.  在**实例列表**页面，找到目标全球加速实例，单击**操作**列下的**配置监听**。

3.  在**监听**页签下，找到目标监听，然后单击监听实例ID。

4.  在监听实例详情页面下，单击**转发策略**页签。

5.  在**转发策略**页签下，找到目标转发策略，单击右上角的![编辑图表](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/8034281161/p235154.png)图标，编辑转发策略，然后单击**保存**。


## 删除转发策略

1.  登录[全球加速管理控制台](https://ga.console.aliyun.com/list)。

2.  在**实例列表**页面，找到目标全球加速实例，单击**操作**列下的**配置监听**。

3.  在**监听**页签下，找到目标监听，然后单击监听实例ID。

4.  在监听实例详情页面下，单击**转发策略**页签。

5.  在**转发策略**页签下，找到目标转发策略，单击右上角的![删除图表](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/8034281161/p235318.png)图标。

6.  在弹出的对话框中，确认转发策略ID信息，然后单击**确定删除**。


